<!DOCTYPE html>
<html lang="de"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

<h:head>
    <title>User- und Tripmanagement</title>
    <h:outputScript library="js" name="redirection.js" target="head"/>
    <h:outputScript>
        redirectIfNotAdmin("#{adminBean.admin}","#{adminBean.webpageURL}"+"#{adminBean.homePage}")
    </h:outputScript>
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;libraries=places&amp;key=#{homeBean.googleApiKey}"/>
    <h:outputStylesheet library="css" name="stylesheet.css"/>
</h:head>

<h:body>

    <p:growl id="growl" sticky="true" showDetail="true" life="3000"/>

    <h:form>
        <p:commandButton styleClass="navButtonLeft"
                         id="goToLoginPage"
                         value="Ausloggen"
                         type="submit"
                         action="#{adminBean.doLogout}"
                         ajax="false"/>

        <p:button styleClass="navButtonRight" value="Homepage" outcome="#{adminBean.homePage}"/>
    </h:form>

    <br/>


    <br/>
    <h:form>
        <p:dataTable styleClass="userTable centeredElement centeredText"
                     id="userTable"
                     var="user"
                     value="#{adminBean.userList}"
                     selection="#{adminBean.selectedUsers}"
                     rowKey="#{user.name}">
            <f:facet name="header">
                Nutzer
            </f:facet>
            <p:column styleClass="selectColumn" selectionMode="multiple"/>
            <p:column headerText="Name" filterBy="#{user.name}" filterMatchMode="contains">
                <h:outputText value="#{user.name}"/>
            </p:column>
            <p:column headerText="Admin-Status" filterBy="#{user.admin == 1}" filterMatchMode="equals">
                <f:facet name="filter">
                    <p:selectOneButton onchange="PF('userTable').filter()">
                        <f:converter converterId="javax.faces.Boolean" />
                        <f:selectItem itemLabel="Ja" itemValue="1" />
                        <f:selectItem itemLabel="Nein" itemValue="0" />
                    </p:selectOneButton>
                </f:facet>
                <h:outputText value="#{(user.admin == 1) ? 'Ja':'Nein'}" />
            </p:column>
            <f:facet name="footer">
                <p:commandButton process="userTable"
                                 update="userTable"
                                 value="Löschen"
                                 action="#{adminBean.deleteSelectedUsers}"/>
            </f:facet>
        </p:dataTable>
    </h:form>

    <br/><br/>

    <h:form>
        <p:dataTable styleClass="centeredElement centeredText"
                     id="tripTable"
                     var="trip"
                     value="#{adminBean.tripList}"
                     selection="#{adminBean.selectedTrips}"
                     rowKey="#{trip.tripId}">
            <f:facet name="header">
                Fahrten
            </f:facet>
            <p:column styleClass="selectColumn" selectionMode="multiple"/>
            <p:column headerText="ID">
                <h:outputText value="#{trip.tripId}"/>
            </p:column>
            <p:column headerText="Nutzer">
                <h:outputText value="#{trip.user}"/>
            </p:column>
            <p:column headerText="Von">
                <h:outputText value="#{trip.origin}"/>
            </p:column>
            <p:column headerText="Nach">
                <h:outputText value="#{trip.destination}"/>
            </p:column>
            <p:column headerText="Distanz">
                <h:outputText value="#{trip.distance}"/>
            </p:column>
            <p:column headerText="Datum">
                <h:outputText value="#{trip.date}"/>
            </p:column>
            <f:facet name="footer">
                <p:commandButton process="tripTable"
                                 update="tripTable"
                                 value="Löschen"
                                 action="#{adminBean.deleteSelectedTrips}"/>
            </f:facet>
        </p:dataTable>
    </h:form>
</h:body>
</html>